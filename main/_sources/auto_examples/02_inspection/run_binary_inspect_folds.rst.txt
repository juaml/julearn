
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/02_inspection/run_binary_inspect_folds.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_02_inspection_run_binary_inspect_folds.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_02_inspection_run_binary_inspect_folds.py:


Inspecting the fold-wise predictions
====================================

This example uses the ``iris`` dataset and performs a simple binary
classification using a Support Vector Machine classifier.

We later inspect the predictions of the model for each fold.

.. include:: ../../links.inc

.. GENERATED FROM PYTHON SOURCE LINES 12-23

.. code-block:: default

    # Authors: Federico Raimondo <f.raimondo@fz-juelich.de>
    # License: AGPL

    from seaborn import load_dataset

    from sklearn.model_selection import RepeatedStratifiedKFold, ShuffleSplit

    from julearn import run_cross_validation
    from julearn.pipeline import PipelineCreator
    from julearn.utils import configure_logging








.. GENERATED FROM PYTHON SOURCE LINES 24-25

Set the logging level to info to see extra information.

.. GENERATED FROM PYTHON SOURCE LINES 25-27

.. code-block:: default

    configure_logging(level="INFO")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2024-09-26 13:46:39,631 - julearn - INFO - ===== Lib Versions =====
    2024-09-26 13:46:39,631 - julearn - INFO - numpy: 1.26.4
    2024-09-26 13:46:39,631 - julearn - INFO - scipy: 1.14.1
    2024-09-26 13:46:39,631 - julearn - INFO - sklearn: 1.4.2
    2024-09-26 13:46:39,631 - julearn - INFO - pandas: 2.1.4
    2024-09-26 13:46:39,631 - julearn - INFO - julearn: 0.3.4.dev25
    2024-09-26 13:46:39,631 - julearn - INFO - ========================




.. GENERATED FROM PYTHON SOURCE LINES 28-30

.. code-block:: default

    df_iris = load_dataset("iris")








.. GENERATED FROM PYTHON SOURCE LINES 31-33

The dataset has three kind of species. We will keep two to perform a binary
classification.

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: default

    df_iris = df_iris[df_iris["species"].isin(["versicolor", "virginica"])]








.. GENERATED FROM PYTHON SOURCE LINES 36-38

As features, we will use the sepal length, width and petal length.
We will try to predict the species.

.. GENERATED FROM PYTHON SOURCE LINES 38-60

.. code-block:: default


    X = ["sepal_length", "sepal_width", "petal_length"]
    y = "species"
    X_types = {"continuous": X}

    creator = PipelineCreator(problem_type="classification")
    creator.add("zscore")
    creator.add("svm")

    cv = RepeatedStratifiedKFold(n_splits=5, n_repeats=4, random_state=200)

    scores, model, inspector = run_cross_validation(
        X=X,
        y=y,
        data=df_iris,
        model=creator,
        return_inspector=True,
        cv=cv,
    )

    print(scores)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2024-09-26 13:46:39,634 - julearn - INFO - Adding step zscore that applies to ColumnTypes<types={'continuous'}; pattern=(?:__:type:__continuous)>
    2024-09-26 13:46:39,634 - julearn - INFO - Step added
    2024-09-26 13:46:39,634 - julearn - INFO - Adding step svm that applies to ColumnTypes<types={'continuous'}; pattern=(?:__:type:__continuous)>
    2024-09-26 13:46:39,634 - julearn - INFO - Step added
    2024-09-26 13:46:39,634 - julearn - INFO - ==== Input Data ====
    2024-09-26 13:46:39,634 - julearn - INFO - Using dataframe as input
    2024-09-26 13:46:39,634 - julearn - INFO -      Features: ['sepal_length', 'sepal_width', 'petal_length']
    2024-09-26 13:46:39,634 - julearn - INFO -      Target: species
    2024-09-26 13:46:39,634 - julearn - INFO -      Expanded features: ['sepal_length', 'sepal_width', 'petal_length']
    2024-09-26 13:46:39,634 - julearn - INFO -      X_types:{}
    2024-09-26 13:46:39,635 - julearn - WARNING - The following columns are not defined in X_types: ['sepal_length', 'sepal_width', 'petal_length']. They will be treated as continuous.
    /home/runner/work/julearn/julearn/julearn/prepare.py:509: RuntimeWarning: The following columns are not defined in X_types: ['sepal_length', 'sepal_width', 'petal_length']. They will be treated as continuous.
      warn_with_log(
    2024-09-26 13:46:39,635 - julearn - INFO - ====================
    2024-09-26 13:46:39,635 - julearn - INFO - 
    2024-09-26 13:46:39,636 - julearn - INFO - = Model Parameters =
    2024-09-26 13:46:39,636 - julearn - INFO - ====================
    2024-09-26 13:46:39,636 - julearn - INFO - 
    2024-09-26 13:46:39,636 - julearn - INFO - = Data Information =
    2024-09-26 13:46:39,636 - julearn - INFO -      Problem type: classification
    2024-09-26 13:46:39,636 - julearn - INFO -      Number of samples: 100
    2024-09-26 13:46:39,636 - julearn - INFO -      Number of features: 3
    2024-09-26 13:46:39,636 - julearn - INFO - ====================
    2024-09-26 13:46:39,636 - julearn - INFO - 
    2024-09-26 13:46:39,636 - julearn - INFO -      Number of classes: 2
    2024-09-26 13:46:39,636 - julearn - INFO -      Target type: object
    2024-09-26 13:46:39,637 - julearn - INFO -      Class distributions: species
    versicolor    50
    virginica     50
    Name: count, dtype: int64
    2024-09-26 13:46:39,637 - julearn - INFO - Using outer CV scheme RepeatedStratifiedKFold(n_repeats=4, n_splits=5, random_state=200) (incl. final model)
    2024-09-26 13:46:39,637 - julearn - INFO - Binary classification problem detected.
        fit_time  score_time  ... fold                          cv_mdsum
    0   0.004943    0.002494  ...    0  42489ff0163b2f12752440a6b7ef74c7
    1   0.004497    0.002456  ...    1  42489ff0163b2f12752440a6b7ef74c7
    2   0.004514    0.002470  ...    2  42489ff0163b2f12752440a6b7ef74c7
    3   0.004456    0.002492  ...    3  42489ff0163b2f12752440a6b7ef74c7
    4   0.004467    0.002449  ...    4  42489ff0163b2f12752440a6b7ef74c7
    5   0.004461    0.002496  ...    0  42489ff0163b2f12752440a6b7ef74c7
    6   0.004450    0.002455  ...    1  42489ff0163b2f12752440a6b7ef74c7
    7   0.004535    0.002470  ...    2  42489ff0163b2f12752440a6b7ef74c7
    8   0.004436    0.002458  ...    3  42489ff0163b2f12752440a6b7ef74c7
    9   0.004399    0.002434  ...    4  42489ff0163b2f12752440a6b7ef74c7
    10  0.004438    0.002475  ...    0  42489ff0163b2f12752440a6b7ef74c7
    11  0.004421    0.002436  ...    1  42489ff0163b2f12752440a6b7ef74c7
    12  0.004466    0.002445  ...    2  42489ff0163b2f12752440a6b7ef74c7
    13  0.004429    0.002480  ...    3  42489ff0163b2f12752440a6b7ef74c7
    14  0.004637    0.002457  ...    4  42489ff0163b2f12752440a6b7ef74c7
    15  0.004402    0.002462  ...    0  42489ff0163b2f12752440a6b7ef74c7
    16  0.004418    0.002429  ...    1  42489ff0163b2f12752440a6b7ef74c7
    17  0.004416    0.002445  ...    2  42489ff0163b2f12752440a6b7ef74c7
    18  0.004447    0.002475  ...    3  42489ff0163b2f12752440a6b7ef74c7
    19  0.004491    0.002449  ...    4  42489ff0163b2f12752440a6b7ef74c7

    [20 rows x 9 columns]




.. GENERATED FROM PYTHON SOURCE LINES 61-62

We can now inspect the predictions of the model for each fold.

.. GENERATED FROM PYTHON SOURCE LINES 62-67

.. code-block:: default


    cv_predictions = inspector.folds.predict()

    print(cv_predictions)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

        repeat0_p0  repeat1_p0  repeat2_p0  repeat3_p0      target
    0   versicolor  versicolor  versicolor  versicolor  versicolor
    1   versicolor  versicolor  versicolor  versicolor  versicolor
    2   versicolor  versicolor  versicolor  versicolor  versicolor
    3   versicolor  versicolor  versicolor  versicolor  versicolor
    4   versicolor  versicolor  versicolor  versicolor  versicolor
    ..         ...         ...         ...         ...         ...
    95   virginica   virginica   virginica   virginica   virginica
    96   virginica   virginica   virginica   virginica   virginica
    97   virginica   virginica   virginica   virginica   virginica
    98   virginica   virginica   virginica   virginica   virginica
    99   virginica   virginica   virginica   virginica   virginica

    [100 rows x 5 columns]




.. GENERATED FROM PYTHON SOURCE LINES 68-69

.. code-block:: default

    inspector.folds[0].model




.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <julearn.inspect._pipeline.PipelineInspector object at 0x7f71556c0130>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.242 seconds)


.. _sphx_glr_download_auto_examples_02_inspection_run_binary_inspect_folds.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: run_binary_inspect_folds.py <run_binary_inspect_folds.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: run_binary_inspect_folds.ipynb <run_binary_inspect_folds.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
