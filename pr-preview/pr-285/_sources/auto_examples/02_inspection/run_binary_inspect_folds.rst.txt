
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/02_inspection/run_binary_inspect_folds.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_02_inspection_run_binary_inspect_folds.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_02_inspection_run_binary_inspect_folds.py:


Inspecting the fold-wise predictions
====================================

This example uses the ``iris`` dataset and performs a simple binary
classification using a Support Vector Machine classifier.

We later inspect the predictions of the model for each fold.

.. include:: ../../links.inc

.. GENERATED FROM PYTHON SOURCE LINES 12-23

.. code-block:: Python

    # Authors: Federico Raimondo <f.raimondo@fz-juelich.de>
    # License: AGPL

    from seaborn import load_dataset

    from sklearn.model_selection import RepeatedStratifiedKFold, ShuffleSplit

    from julearn import run_cross_validation
    from julearn.pipeline import PipelineCreator
    from julearn.utils import configure_logging








.. GENERATED FROM PYTHON SOURCE LINES 24-25

Set the logging level to info to see extra information.

.. GENERATED FROM PYTHON SOURCE LINES 25-27

.. code-block:: Python

    configure_logging(level="INFO")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/julearn/julearn/julearn/utils/logging.py:72: UserWarning: The '__version__' attribute is deprecated and will be removed in MarkupSafe 3.1. Use feature detection, or `importlib.metadata.version("markupsafe")`, instead.
      vstring = str(getattr(module, "__version__", None))
    2025-09-12 05:44:30,228 - julearn - INFO - ===== Lib Versions =====
    2025-09-12 05:44:30,228 - julearn - INFO - numpy: 1.26.4
    2025-09-12 05:44:30,228 - julearn - INFO - scipy: 1.16.2
    2025-09-12 05:44:30,228 - julearn - INFO - sklearn: 1.7.2
    2025-09-12 05:44:30,228 - julearn - INFO - pandas: 2.3.2
    2025-09-12 05:44:30,228 - julearn - INFO - julearn: 0.3.5.dev74
    2025-09-12 05:44:30,228 - julearn - INFO - ========================




.. GENERATED FROM PYTHON SOURCE LINES 28-30

.. code-block:: Python

    df_iris = load_dataset("iris")








.. GENERATED FROM PYTHON SOURCE LINES 31-33

The dataset has three kind of species. We will keep two to perform a binary
classification.

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: Python

    df_iris = df_iris[df_iris["species"].isin(["versicolor", "virginica"])]








.. GENERATED FROM PYTHON SOURCE LINES 36-38

As features, we will use the sepal length, width and petal length.
We will try to predict the species.

.. GENERATED FROM PYTHON SOURCE LINES 38-60

.. code-block:: Python


    X = ["sepal_length", "sepal_width", "petal_length"]
    y = "species"
    X_types = {"continuous": X}

    creator = PipelineCreator(problem_type="classification")
    creator.add("zscore")
    creator.add("svm")

    cv = RepeatedStratifiedKFold(n_splits=5, n_repeats=4, random_state=200)

    scores, model, inspector = run_cross_validation(
        X=X,
        y=y,
        data=df_iris,
        model=creator,
        return_inspector=True,
        cv=cv,
    )

    print(scores)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    2025-09-12 05:44:30,231 - julearn - INFO - Adding step zscore that applies to ColumnTypes<types={'continuous'}; pattern=(?:__:type:__continuous)>
    2025-09-12 05:44:30,231 - julearn - INFO - Step added
    2025-09-12 05:44:30,231 - julearn - INFO - Adding step svm that applies to ColumnTypes<types={'continuous'}; pattern=(?:__:type:__continuous)>
    2025-09-12 05:44:30,231 - julearn - INFO - Step added
    2025-09-12 05:44:30,231 - julearn - INFO - ==== Input Data ====
    2025-09-12 05:44:30,232 - julearn - INFO - Using dataframe as input
    2025-09-12 05:44:30,232 - julearn - INFO -      Features: ['sepal_length', 'sepal_width', 'petal_length']
    2025-09-12 05:44:30,232 - julearn - INFO -      Target: species
    2025-09-12 05:44:30,232 - julearn - INFO -      Expanded features: ['sepal_length', 'sepal_width', 'petal_length']
    2025-09-12 05:44:30,232 - julearn - INFO -      X_types:{}
    2025-09-12 05:44:30,232 - julearn - WARNING - The following columns are not defined in X_types: ['sepal_length', 'sepal_width', 'petal_length']. They will be treated as continuous.
    /home/runner/work/julearn/julearn/julearn/prepare.py:510: RuntimeWarning: The following columns are not defined in X_types: ['sepal_length', 'sepal_width', 'petal_length']. They will be treated as continuous.
      warn_with_log(
    2025-09-12 05:44:30,233 - julearn - INFO - ====================
    2025-09-12 05:44:30,233 - julearn - INFO - 
    2025-09-12 05:44:30,234 - julearn - INFO - = Model Parameters =
    2025-09-12 05:44:30,234 - julearn - INFO - ====================
    2025-09-12 05:44:30,234 - julearn - INFO - 
    2025-09-12 05:44:30,234 - julearn - INFO - = Data Information =
    2025-09-12 05:44:30,234 - julearn - INFO -      Problem type: classification
    2025-09-12 05:44:30,234 - julearn - INFO -      Number of samples: 100
    2025-09-12 05:44:30,234 - julearn - INFO -      Number of features: 3
    2025-09-12 05:44:30,234 - julearn - INFO - ====================
    2025-09-12 05:44:30,234 - julearn - INFO - 
    2025-09-12 05:44:30,234 - julearn - INFO -      Number of classes: 2
    2025-09-12 05:44:30,234 - julearn - INFO -      Target type: object
    2025-09-12 05:44:30,235 - julearn - INFO -      Class distributions: species
    versicolor    50
    virginica     50
    Name: count, dtype: int64
    2025-09-12 05:44:30,235 - julearn - INFO - Using outer CV scheme RepeatedStratifiedKFold(n_repeats=4, n_splits=5, random_state=200) (incl. final model)
    2025-09-12 05:44:30,236 - julearn - INFO - Binary classification problem detected.
        fit_time  score_time  ... fold                          cv_mdsum
    0   0.004358    0.002531  ...    0  42489ff0163b2f12752440a6b7ef74c7
    1   0.004395    0.002517  ...    1  42489ff0163b2f12752440a6b7ef74c7
    2   0.004261    0.002544  ...    2  42489ff0163b2f12752440a6b7ef74c7
    3   0.004261    0.002538  ...    3  42489ff0163b2f12752440a6b7ef74c7
    4   0.004295    0.002531  ...    4  42489ff0163b2f12752440a6b7ef74c7
    5   0.004308    0.002481  ...    0  42489ff0163b2f12752440a6b7ef74c7
    6   0.004248    0.002561  ...    1  42489ff0163b2f12752440a6b7ef74c7
    7   0.004285    0.002529  ...    2  42489ff0163b2f12752440a6b7ef74c7
    8   0.004262    0.002566  ...    3  42489ff0163b2f12752440a6b7ef74c7
    9   0.004253    0.002522  ...    4  42489ff0163b2f12752440a6b7ef74c7
    10  0.004315    0.002546  ...    0  42489ff0163b2f12752440a6b7ef74c7
    11  0.004308    0.002570  ...    1  42489ff0163b2f12752440a6b7ef74c7
    12  0.004317    0.002567  ...    2  42489ff0163b2f12752440a6b7ef74c7
    13  0.004293    0.002542  ...    3  42489ff0163b2f12752440a6b7ef74c7
    14  0.004273    0.002517  ...    4  42489ff0163b2f12752440a6b7ef74c7
    15  0.004292    0.002497  ...    0  42489ff0163b2f12752440a6b7ef74c7
    16  0.004264    0.002544  ...    1  42489ff0163b2f12752440a6b7ef74c7
    17  0.004285    0.002512  ...    2  42489ff0163b2f12752440a6b7ef74c7
    18  0.004286    0.002522  ...    3  42489ff0163b2f12752440a6b7ef74c7
    19  0.004250    0.002516  ...    4  42489ff0163b2f12752440a6b7ef74c7

    [20 rows x 9 columns]




.. GENERATED FROM PYTHON SOURCE LINES 61-62

We can now inspect the predictions of the model for each fold.

.. GENERATED FROM PYTHON SOURCE LINES 62-67

.. code-block:: Python


    cv_predictions = inspector.folds.predict()

    print(cv_predictions)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

             target repeat0_p0 repeat1_p0 repeat2_p0 repeat3_p0
    50   versicolor  virginica  virginica  virginica  virginica
    51   versicolor  virginica  virginica  virginica  virginica
    52   versicolor  virginica  virginica  virginica  virginica
    53   versicolor  virginica  virginica  virginica  virginica
    54   versicolor  virginica  virginica  virginica  virginica
    ..          ...        ...        ...        ...        ...
    145   virginica        NaN        NaN        NaN        NaN
    146   virginica        NaN        NaN        NaN        NaN
    147   virginica        NaN        NaN        NaN        NaN
    148   virginica        NaN        NaN        NaN        NaN
    149   virginica        NaN        NaN        NaN        NaN

    [100 rows x 5 columns]




.. GENERATED FROM PYTHON SOURCE LINES 68-69

.. code-block:: Python

    inspector.folds[0].model




.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <julearn.inspect._pipeline.PipelineInspector object at 0x7f9affa6a120>




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.237 seconds)


.. _sphx_glr_download_auto_examples_02_inspection_run_binary_inspect_folds.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: run_binary_inspect_folds.ipynb <run_binary_inspect_folds.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: run_binary_inspect_folds.py <run_binary_inspect_folds.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: run_binary_inspect_folds.zip <run_binary_inspect_folds.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
