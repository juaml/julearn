<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="3.4. Inspecting Models" href="model_inspect.html" /><link rel="prev" title="3.2. Cross-validation consistent Confound Removal" href="confound_removal.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>3.3. Hyperparameter Tuning - julearn documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">julearn  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/julearn_logo_it.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">julearn  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">1. Getting started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../what_really_need_know/index.html">2. What you really need to know</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../what_really_need_know/cross_validation.html">2.1. Why cross validation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what_really_need_know/data.html">2.2. Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what_really_need_know/pipeline.html">2.3. Model Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what_really_need_know/model_evaluation.html">2.4. Model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../what_really_need_know/model_comparison.html">2.5. Model comparison</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">3. Selected deeper topics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="target_transformers.html">3.1. Applying preprocessing to the target</a></li>
<li class="toctree-l2"><a class="reference internal" href="confound_removal.html">3.2. Cross-validation consistent Confound Removal</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">3.3. Hyperparameter Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_inspect.html">3.4. Inspecting Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="cross_validation_splitter.html">3.5. Cross-validation splitters</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacked_models.html">3.6. Stacking Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="CBPM.html">3.7. Connectome-based Predictive Modeling (CBPM)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../available_pipeline_steps.html">4. Overview of available Pipeline Steps</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples.html">5. Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/00_starting/index.html">5.1. Starting with julearn</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_combine_pandas.html">Working with pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_simple_binary_classification.html">Simple Binary Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_grouped_cv.html">Grouped CV.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_cm_acc_multiclass.html">Multiclass Classification.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_stratified_kfold_reg.html">Stratified K-fold CV for regression analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_example_regression.html">Regression Analysis</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/01_model_comparison/index.html">5.2. Model Comparison</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/01_model_comparison/plot_simple_model_comparison.html">Simple Model Comparison</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/02_inspection/index.html">5.3. Inspection</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/run_binary_inspect_folds.html">Inspecting the fold-wise predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_inspect_random_forest.html">Inspecting Random Forest models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_groupcv_inspect_svm.html">Inspecting SVM models.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_preprocess.html">Preprocessing with variance threshold, zscore and PCA</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/03_complex_models/index.html">5.4. Complex Models</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_apply_to_target.html">Transforming target variable with z-score.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_hyperparameter_multiple_grids.html">Tuning Multiple Hyperparameters Grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_stacked_models.html">Stacking Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_hyperparameter_tuning.html">Tuning Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_example_pca_featsets.html">Regression Analysis</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/04_confounds/index.html">5.5. Confounds</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/04_confounds/run_return_confounds.html">Return Confounds in Confound Removal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/04_confounds/plot_confound_removal_classification.html">Confound Removal (model comparison)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/05_customization/index.html">5.6. Customization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/05_customization/run_custom_scorers_regression.html">Custom Scoring Function for Regression</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">6. Reference</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/main.html">6.1. Main API</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.run_cross_validation.html">julearn.run_cross_validation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/pipeline.html">6.2. Pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.PipelineCreator.html">julearn.PipelineCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.TargetPipelineCreator.html">julearn.TargetPipelineCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.pipeline.JuTargetPipeline.html">julearn.pipeline.JuTargetPipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.pipeline.pipeline_creator.Step.html">julearn.pipeline.pipeline_creator.Step</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/model_selection.html">6.3. Model Selection</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.ContinuousStratifiedKFold.html">julearn.model_selection.ContinuousStratifiedKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.RepeatedContinuousStratifiedKFold.html">julearn.model_selection.RepeatedContinuousStratifiedKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.ContinuousStratifiedGroupKFold.html">julearn.model_selection.ContinuousStratifiedGroupKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.RepeatedContinuousStratifiedGroupKFold.html">julearn.model_selection.RepeatedContinuousStratifiedGroupKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.StratifiedBootstrap.html">julearn.model_selection.StratifiedBootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.get_searcher.html">julearn.model_selection.get_searcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.list_searchers.html">julearn.model_selection.list_searchers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.register_searcher.html">julearn.model_selection.register_searcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.reset_searcher_register.html">julearn.model_selection.reset_searcher_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/base.html">6.4. Base</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.JuBaseEstimator.html">julearn.base.JuBaseEstimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.JuTransformer.html">julearn.base.JuTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.WrapModel.html">julearn.base.WrapModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ColumnTypes.html">julearn.base.ColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ColumnTypesLike.html">julearn.base.ColumnTypesLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.change_column_type.html">julearn.base.change_column_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.get_column_type.html">julearn.base.get_column_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.make_type_selector.html">julearn.base.make_type_selector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ensure_column_types.html">julearn.base.ensure_column_types</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/inspect.html">6.5. Inspect</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.inspect.Inspector.html">julearn.inspect.Inspector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.inspect.FoldsInspector.html">julearn.inspect.FoldsInspector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.inspect.preprocess.html">julearn.inspect.preprocess</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/models.html">6.6. Models</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.list_models.html">julearn.models.list_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.get_model.html">julearn.models.get_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.register_model.html">julearn.models.register_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.reset_model_register.html">julearn.models.reset_model_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/models.html#dynamic-selection-deslib">6.7. Dynamic Selection (DESLib)</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.dynamic.DynamicSelection.html">julearn.models.dynamic.DynamicSelection</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/scoring.html">6.8. Scoring</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.get_scorer.html">julearn.scoring.get_scorer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.list_scorers.html">julearn.scoring.list_scorers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.register_scorer.html">julearn.scoring.register_scorer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.reset_scorer_register.html">julearn.scoring.reset_scorer_register</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.check_scoring.html">julearn.scoring.check_scoring</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/scoring.html#module-julearn.scoring.metrics">6.9. Scoring Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.metrics.r_corr.html">julearn.scoring.metrics.r_corr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.metrics.r2_corr.html">julearn.scoring.metrics.r2_corr</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/transformers.html">6.10. Transformers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.DropColumns.html">julearn.transformers.DropColumns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.ChangeColumnTypes.html">julearn.transformers.ChangeColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.SetColumnTypes.html">julearn.transformers.SetColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.FilterColumns.html">julearn.transformers.FilterColumns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.CBPM.html">julearn.transformers.CBPM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.JuColumnTransformer.html">julearn.transformers.JuColumnTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.confound_remover.ConfoundRemover.html">julearn.transformers.confound_remover.ConfoundRemover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.list_transformers.html">julearn.transformers.list_transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.get_transformer.html">julearn.transformers.get_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.register_transformer.html">julearn.transformers.register_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.reset_transformer_register.html">julearn.transformers.reset_transformer_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/transformers.html#module-julearn.transformers.target">6.11. Target Transformers</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.JuTransformedTargetModel.html">julearn.transformers.target.JuTransformedTargetModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.JuTargetTransformer.html">julearn.transformers.target.JuTargetTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.TargetConfoundRemover.html">julearn.transformers.target.TargetConfoundRemover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.TransformedTargetWarning.html">julearn.transformers.target.TransformedTargetWarning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.get_target_transformer.html">julearn.transformers.target.get_target_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.list_target_transformers.html">julearn.transformers.target.list_target_transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.register_target_transformer.html">julearn.transformers.target.register_target_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.reset_target_transformer_register.html">julearn.transformers.target.reset_target_transformer_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/utils.html">6.12. Utils</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.logger.html">julearn.utils.logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.configure_logging.html">julearn.utils.configure_logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.raise_error.html">julearn.utils.raise_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.warn_with_log.html">julearn.utils.warn_with_log</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/utils.html#module-julearn.utils.typing">6.13. Typing</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.JuEstimatorLike.html">julearn.utils.typing.JuEstimatorLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLike.html">julearn.utils.typing.EstimatorLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFit1.html">julearn.utils.typing.EstimatorLikeFit1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFit2.html">julearn.utils.typing.EstimatorLikeFit2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFity.html">julearn.utils.typing.EstimatorLikeFity</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/prepare.html">6.14. Prepare</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.prepare.prepare_input_data.html">julearn.prepare.prepare_input_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.prepare.check_consistency.html">julearn.prepare.check_consistency</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/stats.html">6.15. Stats</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.stats.corrected_ttest.html">julearn.stats.corrected_ttest</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/viz.html">6.16. Vizualization</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.viz.plot_scores.html">julearn.viz.plot_scores</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">7. Contributing to julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintaining.html">8. Maintaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">9. Frequenly Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">10. What’s new</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="hyperparameter-tuning">
<span id="sphx-glr-auto-examples-99-docs-run-hyperparameters-docs-py"></span><span id="hp-tuning"></span><h1><span class="section-number">3.3. </span>Hyperparameter Tuning<a class="headerlink" href="#hyperparameter-tuning" title="Permalink to this heading">#</a></h1>
<section id="parameters-vs-hyperparameters">
<h2>Parameters vs Hyperparameters<a class="headerlink" href="#parameters-vs-hyperparameters" title="Permalink to this heading">#</a></h2>
<p>Parameters are the values that define the model, and are learned from the data.
For example, the weights of a linear regression model are parameters. The
parameters of a model are learned during training and are not set by the user.</p>
<p>Hyperparameters are the values that define the model, but are not learned from
the data. For example, the regularization parameter <code class="docutils literal notranslate"><span class="pre">C</span></code> of a Support Vector
Machine (<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a>) model is a hyperparameter. The
hyperparameters of a model are set by the user before training and are not
learned during training.</p>
<p>Let’s see an example of a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> model with a regularization
parameter <code class="docutils literal notranslate"><span class="pre">C</span></code>. We will use the <code class="docutils literal notranslate"><span class="pre">iris</span></code> dataset, which is a dataset of
measurements of flowers.</p>
<p>Lets start by loading the dataset and setting the features and target
variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">seaborn</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>  <span class="c1"># To print in a pretty way</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span>
<span class="n">X_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;continuous&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">}</span>

<span class="c1"># The dataset has three kind of species. We will keep two to perform a binary</span>
<span class="c1"># classification.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;versicolor&quot;</span><span class="p">,</span> <span class="s2">&quot;virginica&quot;</span><span class="p">])]</span>
</pre></div>
</div>
<p>We can now use the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> to create a pipeline with a
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.RobustScaler.html#sklearn.preprocessing.RobustScaler" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RobustScaler</span></code></a> and a
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a>, with a regularization parameter <code class="docutils literal notranslate"><span class="pre">C</span></code> set to
<code class="docutils literal notranslate"><span class="pre">0.1</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">julearn.pipeline</span> <span class="kn">import</span> <span class="n">PipelineCreator</span>

<span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:29,030 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,031 - julearn - INFO - Step added
2023-07-07 07:55:29,031 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,031 - julearn - INFO - Setting hyperparameter C = 0.1
2023-07-07 07:55:29,031 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC(C=0.1)
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
</pre></div>
</div>
</section>
<section id="id1">
<h2>Hyperparameter Tuning<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Since it is the user who sets the hyperparameters, it is important to choose
the right values. This is not always easy, and it is common to try different
values and see which one works best. This process is called <em>hyperparameter
tuning</em>.</p>
<p>Basically, hyperparameter tuning refers to testing several hyperparameter
values and choosing the one that works best.</p>
<p>For example, we can try different values for the regularization parameter
<code class="docutils literal notranslate"><span class="pre">C</span></code> of the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> model and see which one works best.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">julearn</span> <span class="kn">import</span> <span class="n">run_cross_validation</span>

<span class="n">scores1</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score with C=0.1: </span><span class="si">{</span><span class="n">scores1</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">creator2</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">scores2</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator2</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score with C=0.01: </span><span class="si">{</span><span class="n">scores2</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:29,033 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:29,033 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:29,033 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,033 - julearn - INFO -      Target: species
2023-07-07 07:55:29,033 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,033 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:29,034 - julearn - INFO - ====================
2023-07-07 07:55:29,034 - julearn - INFO -
2023-07-07 07:55:29,035 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:29,035 - julearn - INFO - ====================
2023-07-07 07:55:29,035 - julearn - INFO -
2023-07-07 07:55:29,035 - julearn - INFO - = Data Information =
2023-07-07 07:55:29,035 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:29,035 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:29,036 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:29,036 - julearn - INFO - ====================
2023-07-07 07:55:29,036 - julearn - INFO -
2023-07-07 07:55:29,036 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:29,036 - julearn - INFO -      Target type: object
2023-07-07 07:55:29,037 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:29,037 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:29,037 - julearn - INFO - Binary classification problem detected.
Score with C=0.1: 0.8099999999999999
2023-07-07 07:55:29,098 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,099 - julearn - INFO - Step added
2023-07-07 07:55:29,099 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,099 - julearn - INFO - Setting hyperparameter C = 0.01
2023-07-07 07:55:29,099 - julearn - INFO - Step added
2023-07-07 07:55:29,099 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:29,099 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:29,099 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,099 - julearn - INFO -      Target: species
2023-07-07 07:55:29,099 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,099 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:29,100 - julearn - INFO - ====================
2023-07-07 07:55:29,100 - julearn - INFO -
2023-07-07 07:55:29,101 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:29,101 - julearn - INFO - ====================
2023-07-07 07:55:29,101 - julearn - INFO -
2023-07-07 07:55:29,101 - julearn - INFO - = Data Information =
2023-07-07 07:55:29,101 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:29,102 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:29,102 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:29,102 - julearn - INFO - ====================
2023-07-07 07:55:29,102 - julearn - INFO -
2023-07-07 07:55:29,102 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:29,102 - julearn - INFO -      Target type: object
2023-07-07 07:55:29,103 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:29,103 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:29,103 - julearn - INFO - Binary classification problem detected.
Score with C=0.01: 0.19
</pre></div>
</div>
<p>We can see that the model with <code class="docutils literal notranslate"><span class="pre">C=0.1</span></code> works better than the model with
<code class="docutils literal notranslate"><span class="pre">C=0.01</span></code>. However, to be sure that <code class="docutils literal notranslate"><span class="pre">C=0.1</span></code> is the best value, we should
try more values. And since this is only one hyperparameter, it is not that
difficult. But what if we have more hyperparameters? And what if we have
several steps in the pipeline (e.g. feature selection, PCA, etc.)?
This has a main problem: the more hyperparameters we have, the more
times we use the same data for training and testing. This usually gives an
optimistic estimation of the performance of the model.</p>
<p>To prevent this, we can use a technique called <em>nested cross-validation</em>.
That is, we use cross-validation to <em>tune the hyperparameters</em>, and then we
use cross-validation again to estimate the performance of the model using
the best hyperparameters set. It is called <em>nested</em> because we first split
the data into training and testing sets to estimate the model performance
(outer loop), and then we split the training set into two sets to tune the
hyperparameters (inner loop).</p>
<p>Julearn has a simple way to do hyperparameter tuning using nested cross-
validation. When we use a <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> to create a pipeline,
we can set the hyperparameters we want to tune and the values we want to try.</p>
<p>For example, we can try different values for the regularization parameter
<code class="docutils literal notranslate"><span class="pre">C</span></code> of the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:29,163 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,164 - julearn - INFO - Step added
2023-07-07 07:55:29,164 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:29,164 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:55:29,164 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10]}
</pre></div>
</div>
<p>As we can see above, the creator now shows that the <code class="docutils literal notranslate"><span class="pre">C</span></code> hyperparameter
will be tuned. We can now use this creator to run cross-validation. This will
tune the hyperparameters and estimate the performance of the model using the
best hyperparameters set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scores_tuned</span><span class="p">,</span> <span class="n">model_tuned</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores_tuned</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:29,165 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:29,165 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:29,165 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,165 - julearn - INFO -      Target: species
2023-07-07 07:55:29,166 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:29,166 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:29,167 - julearn - INFO - ====================
2023-07-07 07:55:29,167 - julearn - INFO -
2023-07-07 07:55:29,167 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:29,167 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:55:29,168 - julearn - INFO - Hyperparameters:
2023-07-07 07:55:29,168 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:55:29,168 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:29,168 - julearn - INFO - Search Parameters:
2023-07-07 07:55:29,168 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:29,168 - julearn - INFO - ====================
2023-07-07 07:55:29,168 - julearn - INFO -
2023-07-07 07:55:29,168 - julearn - INFO - = Data Information =
2023-07-07 07:55:29,168 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:29,168 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:29,168 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:29,169 - julearn - INFO - ====================
2023-07-07 07:55:29,169 - julearn - INFO -
2023-07-07 07:55:29,169 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:29,169 - julearn - INFO -      Target type: object
2023-07-07 07:55:29,170 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:29,170 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:29,170 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.9100000000000001
</pre></div>
</div>
<p>We can see that the model with the best hyperparameters works better than
the model with <code class="docutils literal notranslate"><span class="pre">C=0.1</span></code>. But what’s the best hyperparameter set? We can
see it by printing the <code class="docutils literal notranslate"><span class="pre">model_tuned.best_params_</span></code> variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">model_tuned</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;svm__C&#39;: 1}
</pre></div>
</div>
<p>We can see that the best hyperparameter set is <code class="docutils literal notranslate"><span class="pre">C=1</span></code>. Since this
hyperparameter was not on the boundary of the values we tried, we can
conclude that our search for the best <code class="docutils literal notranslate"><span class="pre">C</span></code> value was successful.</p>
<p>However, by checking on the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> documentation, we can
see that there are more hyperparameters that we can tune. For example, for
the default <code class="docutils literal notranslate"><span class="pre">rbf</span></code> kernel, we can tune the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> hyperparameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>

<span class="n">scores_tuned</span><span class="p">,</span> <span class="n">model_tuned</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores_tuned</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model_tuned</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:30,652 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:30,652 - julearn - INFO - Step added
2023-07-07 07:55:30,652 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:30,652 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:55:30,653 - julearn - INFO - Tuning hyperparameter gamma = [0.01, 0.1, 1, 10]
2023-07-07 07:55:30,653 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10], &#39;svm__gamma&#39;: [0.01, 0.1, 1, 10]}

2023-07-07 07:55:30,653 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:30,653 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:30,653 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:30,654 - julearn - INFO -      Target: species
2023-07-07 07:55:30,654 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:30,654 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:30,655 - julearn - INFO - ====================
2023-07-07 07:55:30,655 - julearn - INFO -
2023-07-07 07:55:30,655 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:30,655 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:55:30,656 - julearn - INFO - Hyperparameters:
2023-07-07 07:55:30,656 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:55:30,656 - julearn - INFO -      svm__gamma: [0.01, 0.1, 1, 10]
2023-07-07 07:55:30,656 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:30,656 - julearn - INFO - Search Parameters:
2023-07-07 07:55:30,656 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:30,656 - julearn - INFO - ====================
2023-07-07 07:55:30,656 - julearn - INFO -
2023-07-07 07:55:30,656 - julearn - INFO - = Data Information =
2023-07-07 07:55:30,656 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:30,656 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:30,657 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:30,657 - julearn - INFO - ====================
2023-07-07 07:55:30,657 - julearn - INFO -
2023-07-07 07:55:30,657 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:30,657 - julearn - INFO -      Target type: object
2023-07-07 07:55:30,658 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:30,658 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:30,658 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.9100000000000001
{&#39;svm__C&#39;: 10, &#39;svm__gamma&#39;: 0.01}
</pre></div>
</div>
<p>We can see that the best hyperparameter set is <code class="docutils literal notranslate"><span class="pre">C=1</span></code> and <code class="docutils literal notranslate"><span class="pre">gamma=0.1</span></code>.
But since <code class="docutils literal notranslate"><span class="pre">gamma</span></code> was on the boundary of the values we tried, we should
try more values to be sure that we are using the best hyperparameter set.</p>
<p>We can even give a mixture of different variable types, like the words
<code class="docutils literal notranslate"><span class="pre">&quot;scale&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> for the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> hyperparameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>

<span class="n">scores_tuned</span><span class="p">,</span> <span class="n">model_tuned</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores_tuned</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model_tuned</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:36,328 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:36,328 - julearn - INFO - Step added
2023-07-07 07:55:36,328 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:36,328 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:55:36,329 - julearn - INFO - Tuning hyperparameter gamma = [1e-05, 0.0001, 0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:55:36,329 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10], &#39;svm__gamma&#39;: [1e-05, 0.0001, 0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]}

2023-07-07 07:55:36,329 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:36,329 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:36,330 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:36,330 - julearn - INFO -      Target: species
2023-07-07 07:55:36,330 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:36,330 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:36,331 - julearn - INFO - ====================
2023-07-07 07:55:36,331 - julearn - INFO -
2023-07-07 07:55:36,332 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:36,332 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:55:36,332 - julearn - INFO - Hyperparameters:
2023-07-07 07:55:36,332 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:55:36,332 - julearn - INFO -      svm__gamma: [1e-05, 0.0001, 0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:55:36,332 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:36,332 - julearn - INFO - Search Parameters:
2023-07-07 07:55:36,332 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:36,332 - julearn - INFO - ====================
2023-07-07 07:55:36,333 - julearn - INFO -
2023-07-07 07:55:36,333 - julearn - INFO - = Data Information =
2023-07-07 07:55:36,333 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:36,333 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:36,333 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:36,333 - julearn - INFO - ====================
2023-07-07 07:55:36,333 - julearn - INFO -
2023-07-07 07:55:36,333 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:36,333 - julearn - INFO -      Target type: object
2023-07-07 07:55:36,334 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:36,334 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:36,334 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.9100000000000001
{&#39;svm__C&#39;: 10, &#39;svm__gamma&#39;: 0.01}
</pre></div>
</div>
<p>We can even tune hyperparameters from different steps of the pipeline. Let’s
add a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html#sklearn.feature_selection.SelectKBest" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SelectKBest</span></code></a> step to the pipeline
and tune its <code class="docutils literal notranslate"><span class="pre">k</span></code> hyperparameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;select_k&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>

<span class="n">scores_tuned</span><span class="p">,</span> <span class="n">model_tuned</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores_tuned</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model_tuned</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:55:44,831 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:44,831 - julearn - INFO - Step added
2023-07-07 07:55:44,831 - julearn - INFO - Adding step select_k that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:44,831 - julearn - INFO - Tuning hyperparameter k = [2, 3, 4]
2023-07-07 07:55:44,831 - julearn - INFO - Step added
2023-07-07 07:55:44,831 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:55:44,831 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:55:44,831 - julearn - INFO - Tuning hyperparameter gamma = [0.001, 0.01, 0.1, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:55:44,832 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: select_k
    estimator:     SelectKBest()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;select_k__k&#39;: [2, 3, 4]}
  Step 2: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10], &#39;svm__gamma&#39;: [0.001, 0.01, 0.1, &#39;scale&#39;, &#39;auto&#39;]}

2023-07-07 07:55:44,833 - julearn - INFO - ==== Input Data ====
2023-07-07 07:55:44,833 - julearn - INFO - Using dataframe as input
2023-07-07 07:55:44,833 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:44,833 - julearn - INFO -      Target: species
2023-07-07 07:55:44,833 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:55:44,833 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:55:44,834 - julearn - INFO - ====================
2023-07-07 07:55:44,834 - julearn - INFO -
2023-07-07 07:55:44,835 - julearn - INFO - = Model Parameters =
2023-07-07 07:55:44,835 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:55:44,835 - julearn - INFO - Hyperparameters:
2023-07-07 07:55:44,835 - julearn - INFO -      select_k__k: [2, 3, 4]
2023-07-07 07:55:44,835 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:55:44,835 - julearn - INFO -      svm__gamma: [0.001, 0.01, 0.1, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:55:44,835 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:44,835 - julearn - INFO - Search Parameters:
2023-07-07 07:55:44,836 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:44,836 - julearn - INFO - ====================
2023-07-07 07:55:44,836 - julearn - INFO -
2023-07-07 07:55:44,836 - julearn - INFO - = Data Information =
2023-07-07 07:55:44,836 - julearn - INFO -      Problem type: classification
2023-07-07 07:55:44,836 - julearn - INFO -      Number of samples: 100
2023-07-07 07:55:44,836 - julearn - INFO -      Number of features: 4
2023-07-07 07:55:44,836 - julearn - INFO - ====================
2023-07-07 07:55:44,836 - julearn - INFO -
2023-07-07 07:55:44,836 - julearn - INFO -      Number of classes: 2
2023-07-07 07:55:44,836 - julearn - INFO -      Target type: object
2023-07-07 07:55:44,837 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:55:44,837 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:55:44,838 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.9100000000000001
{&#39;select_k__k&#39;: 4, &#39;svm__C&#39;: 10, &#39;svm__gamma&#39;: 0.01}
</pre></div>
</div>
<p>But how will Julearn find the optimal hyperparameter set?</p>
</section>
<section id="searchers">
<h2>Searchers<a class="headerlink" href="#searchers" title="Permalink to this heading">#</a></h2>
<p>Julearn uses the same concept as <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> to tune hyperparameters: it
uses a <em>searcher</em> to find the best hyperparameter set. A searcher is an
object that receives a set of hyperparameters and their values, and then
tries to find the best combination of values for the hyperparameters using
cross-validation.</p>
<p>By default, Julearn uses a <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a>.
This searcher is very simple. First, it construct the “grid” of
hyperparameters to try. As we see above, we have 3 hyperparameters to tune.
So it constructs a 3-dimentional grid with all the possible combinations of
the hyperparameters values. The second step is to perform cross-validation
on each of the possible combinations of hyperparameters values.</p>
<p>Another searcher that Julearn provides is the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code></a>. This searcher is
similar to the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a>, but instead
of trying all the possible combinations of hyperparameters values, it tries
a random subset of them. This is useful when we have a lot of hyperparameters
to tune, since it can be very time consuming to try all the possible, as well
as continuous parameters that can be sampled out of a distribution. For
more information, see the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomizedSearchCV</span></code></a> documentation.</p>
</section>
<section id="tuning-more-than-one-grid">
<h2>Tuning more than one <em>grid</em><a class="headerlink" href="#tuning-more-than-one-grid" title="Permalink to this heading">#</a></h2>
<p>Following our tuning of the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> hyperparameters, we
can also see that we can tune the <code class="docutils literal notranslate"><span class="pre">kernel</span></code> hyperparameter. This
hyperparameter can also be “linear”. Let’s see how our <em>grid</em> of
hyperparameters would look like if we add this hyperparameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;rbf&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:56:11,681 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:11,682 - julearn - INFO - Step added
2023-07-07 07:56:11,682 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:11,682 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,682 - julearn - INFO - Tuning hyperparameter gamma = [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:11,682 - julearn - INFO - Tuning hyperparameter kernel = [&#39;linear&#39;, &#39;rbf&#39;]
2023-07-07 07:56:11,682 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10], &#39;svm__gamma&#39;: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;], &#39;svm__kernel&#39;: [&#39;linear&#39;, &#39;rbf&#39;]}
</pre></div>
</div>
<p>We can see that the <em>grid</em> of hyperparameters is now 3-dimensional. However,
there are some combinations that don’t make much sense. For example, the
<code class="docutils literal notranslate"><span class="pre">gamma</span></code> hyperparameter is only used when the <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is <code class="docutils literal notranslate"><span class="pre">rbf</span></code>. So
we will be trying the <code class="docutils literal notranslate"><span class="pre">linear</span></code> kernel with each one of the 4 different
<code class="docutils literal notranslate"><span class="pre">gamma</span></code> and 4 different <code class="docutils literal notranslate"><span class="pre">C</span></code> values. Those are 16 unnecessary combinations.
We can avoid this by using multiple <em>grids</em>. One grid for the <code class="docutils literal notranslate"><span class="pre">linear</span></code>
kernel and one grid for the <code class="docutils literal notranslate"><span class="pre">rbf</span></code> kernel.</p>
<p>Julearn allows to specify multiple <em>grid</em> using two different approaches.</p>
<ol class="arabic simple">
<li><p>Repeating the step name with different hyperparameters:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">creator</span><span class="p">)</span>


<span class="n">scores1</span><span class="p">,</span> <span class="n">model1</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores1</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:56:11,684 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:11,684 - julearn - INFO - Step added
2023-07-07 07:56:11,684 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:11,684 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,684 - julearn - INFO - Tuning hyperparameter gamma = [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:11,684 - julearn - INFO - Setting hyperparameter kernel = rbf
2023-07-07 07:56:11,684 - julearn - INFO - Step added
2023-07-07 07:56:11,685 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:11,685 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,685 - julearn - INFO - Setting hyperparameter kernel = linear
2023-07-07 07:56:11,685 - julearn - INFO - Step added
PipelineCreator:
  Step 0: zscore
    estimator:     StandardScaler()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {}
  Step 1: svm
    estimator:     SVC()
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10], &#39;svm__gamma&#39;: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]}
  Step 2: svm
    estimator:     SVC(kernel=&#39;linear&#39;)
    apply to:      ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    needed types:  ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
    tuning params: {&#39;svm__C&#39;: [0.01, 0.1, 1, 10]}

2023-07-07 07:56:11,686 - julearn - INFO - ==== Input Data ====
2023-07-07 07:56:11,686 - julearn - INFO - Using dataframe as input
2023-07-07 07:56:11,686 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:11,686 - julearn - INFO -      Target: species
2023-07-07 07:56:11,686 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:11,686 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:56:11,687 - julearn - INFO - ====================
2023-07-07 07:56:11,687 - julearn - INFO -
2023-07-07 07:56:11,688 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:11,688 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:11,688 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:11,688 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,688 - julearn - INFO -      svm__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:11,688 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,689 - julearn - INFO - Search Parameters:
2023-07-07 07:56:11,689 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,689 - julearn - INFO - ====================
2023-07-07 07:56:11,689 - julearn - INFO -
2023-07-07 07:56:11,689 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:11,690 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:11,690 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:11,690 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,690 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,690 - julearn - INFO - Search Parameters:
2023-07-07 07:56:11,690 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,690 - julearn - INFO - ====================
2023-07-07 07:56:11,690 - julearn - INFO -
2023-07-07 07:56:11,690 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:11,690 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:11,690 - julearn - INFO - Hyperparameters list:
2023-07-07 07:56:11,691 - julearn - INFO -      Set 0
2023-07-07 07:56:11,691 - julearn - INFO -              svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,691 - julearn - INFO -              svm__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:11,691 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:11,691 - julearn - INFO -              svm: [SVC()]
2023-07-07 07:56:11,691 - julearn - INFO -      Set 1
2023-07-07 07:56:11,692 - julearn - INFO -              svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:11,692 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:11,692 - julearn - INFO -              svm: [SVC(kernel=&#39;linear&#39;)]
2023-07-07 07:56:11,692 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,693 - julearn - INFO - Search Parameters:
2023-07-07 07:56:11,693 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,693 - julearn - INFO - ====================
2023-07-07 07:56:11,693 - julearn - INFO -
2023-07-07 07:56:11,693 - julearn - INFO - = Data Information =
2023-07-07 07:56:11,693 - julearn - INFO -      Problem type: classification
2023-07-07 07:56:11,693 - julearn - INFO -      Number of samples: 100
2023-07-07 07:56:11,693 - julearn - INFO -      Number of features: 4
2023-07-07 07:56:11,693 - julearn - INFO - ====================
2023-07-07 07:56:11,693 - julearn - INFO -
2023-07-07 07:56:11,693 - julearn - INFO -      Number of classes: 2
2023-07-07 07:56:11,693 - julearn - INFO -      Target type: object
2023-07-07 07:56:11,694 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:56:11,695 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:11,695 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.93
{&#39;set_column_types&#39;: SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]}),
 &#39;svm&#39;: SVC(C=10, gamma=0.01),
 &#39;svm__C&#39;: 10,
 &#39;svm__gamma&#39;: 0.01}
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter is required when repeating a step name.
If we do not specify the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter, julearn will auto-determine
the step name in an unique way. The only way to force repated names is
to do so explicitly.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Using multiple pipeline creators:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator1</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">creator2</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">scores2</span><span class="p">,</span> <span class="n">model2</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">creator1</span><span class="p">,</span> <span class="n">creator2</span><span class="p">],</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores2</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:56:18,920 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:18,920 - julearn - INFO - Step added
2023-07-07 07:56:18,920 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:18,920 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,920 - julearn - INFO - Tuning hyperparameter gamma = [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:18,920 - julearn - INFO - Setting hyperparameter kernel = rbf
2023-07-07 07:56:18,920 - julearn - INFO - Step added
2023-07-07 07:56:18,920 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:18,920 - julearn - INFO - Step added
2023-07-07 07:56:18,921 - julearn - INFO - Adding step svm that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:18,921 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,921 - julearn - INFO - Setting hyperparameter kernel = linear
2023-07-07 07:56:18,921 - julearn - INFO - Step added
2023-07-07 07:56:18,921 - julearn - INFO - ==== Input Data ====
2023-07-07 07:56:18,921 - julearn - INFO - Using dataframe as input
2023-07-07 07:56:18,921 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:18,921 - julearn - INFO -      Target: species
2023-07-07 07:56:18,921 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:18,921 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:56:18,922 - julearn - INFO - ====================
2023-07-07 07:56:18,922 - julearn - INFO -
2023-07-07 07:56:18,923 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:18,923 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:18,923 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:18,923 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,923 - julearn - INFO -      svm__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:18,924 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,924 - julearn - INFO - Search Parameters:
2023-07-07 07:56:18,924 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,924 - julearn - INFO - ====================
2023-07-07 07:56:18,924 - julearn - INFO -
2023-07-07 07:56:18,925 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:18,925 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:18,925 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:18,925 - julearn - INFO -      svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,925 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,925 - julearn - INFO - Search Parameters:
2023-07-07 07:56:18,925 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,925 - julearn - INFO - ====================
2023-07-07 07:56:18,925 - julearn - INFO -
2023-07-07 07:56:18,925 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:18,926 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:18,926 - julearn - INFO - Hyperparameters list:
2023-07-07 07:56:18,926 - julearn - INFO -      Set 0
2023-07-07 07:56:18,926 - julearn - INFO -              svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,926 - julearn - INFO -              svm__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:18,926 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:18,926 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:18,927 - julearn - INFO -              svm: [SVC()]
2023-07-07 07:56:18,927 - julearn - INFO -      Set 1
2023-07-07 07:56:18,927 - julearn - INFO -              svm__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:18,927 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:18,927 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:18,928 - julearn - INFO -              svm: [SVC(kernel=&#39;linear&#39;)]
2023-07-07 07:56:18,928 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,928 - julearn - INFO - Search Parameters:
2023-07-07 07:56:18,928 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,928 - julearn - INFO - ====================
2023-07-07 07:56:18,928 - julearn - INFO -
2023-07-07 07:56:18,928 - julearn - INFO - = Data Information =
2023-07-07 07:56:18,928 - julearn - INFO -      Problem type: classification
2023-07-07 07:56:18,928 - julearn - INFO -      Number of samples: 100
2023-07-07 07:56:18,928 - julearn - INFO -      Number of features: 4
2023-07-07 07:56:18,929 - julearn - INFO - ====================
2023-07-07 07:56:18,929 - julearn - INFO -
2023-07-07 07:56:18,929 - julearn - INFO -      Number of classes: 2
2023-07-07 07:56:18,929 - julearn - INFO -      Target type: object
2023-07-07 07:56:18,929 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:56:18,930 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:18,930 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.93
{&#39;set_column_types&#39;: SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]}),
 &#39;svm&#39;: SVC(C=10, gamma=0.01),
 &#39;svm__C&#39;: 10,
 &#39;svm__gamma&#39;: 0.01,
 &#39;zscore&#39;: StandardScaler()}
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All the pipeline creators must have the same problem type and steps names
in order for this approach to work.</p>
</div>
<p>Indeed, if we compare both approaches, we can see that they are equivalent.
They both produce the same <em>grid</em> of hyperparameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">model1</span><span class="o">.</span><span class="n">param_grid</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model2</span><span class="o">.</span><span class="n">param_grid</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[{&#39;set_column_types&#39;: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})],
  &#39;svm&#39;: [SVC(C=10, gamma=0.01)],
  &#39;svm__C&#39;: [0.01, 0.1, 1, 10],
  &#39;svm__gamma&#39;: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]},
 {&#39;set_column_types&#39;: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})],
  &#39;svm&#39;: [SVC(kernel=&#39;linear&#39;)],
  &#39;svm__C&#39;: [0.01, 0.1, 1, 10]}]
[{&#39;set_column_types&#39;: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})],
  &#39;svm&#39;: [SVC(C=10, gamma=0.01)],
  &#39;svm__C&#39;: [0.01, 0.1, 1, 10],
  &#39;svm__gamma&#39;: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;],
  &#39;zscore&#39;: [StandardScaler()]},
 {&#39;set_column_types&#39;: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})],
  &#39;svm&#39;: [SVC(kernel=&#39;linear&#39;)],
  &#39;svm__C&#39;: [0.01, 0.1, 1, 10],
  &#39;zscore&#39;: [StandardScaler()]}]
</pre></div>
</div>
</section>
<section id="models-as-hyperparameters">
<h2>Models as hyperparameters<a class="headerlink" href="#models-as-hyperparameters" title="Permalink to this heading">#</a></h2>
<p>But why stop there? Models can also be considered as hyperparameters. For
example, we can try different models for the classification task. Let’s
try the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomForestClassifier</span></code></a> and the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LogisticRegression</span></code></a> too:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">creator1</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">creator2</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">creator3</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;rf&quot;</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">creator4</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator4</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator4</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="s2">&quot;logit&quot;</span><span class="p">,</span>
    <span class="n">penalty</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="s2">&quot;l1&quot;</span><span class="p">],</span>
    <span class="n">dual</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">],</span>
    <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;liblinear&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">scores3</span><span class="p">,</span> <span class="n">model3</span> <span class="o">=</span> <span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">creator1</span><span class="p">,</span> <span class="n">creator2</span><span class="p">,</span> <span class="n">creator3</span><span class="p">,</span> <span class="n">creator4</span><span class="p">],</span>
    <span class="n">return_estimator</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scores with best hyperparameter: </span><span class="si">{</span><span class="n">scores3</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">model3</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>2023-07-07 07:56:26,162 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,163 - julearn - INFO - Step added
2023-07-07 07:56:26,163 - julearn - INFO - Adding step model that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,163 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,163 - julearn - INFO - Tuning hyperparameter gamma = [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:26,163 - julearn - INFO - Setting hyperparameter kernel = rbf
2023-07-07 07:56:26,163 - julearn - INFO - Step added
2023-07-07 07:56:26,163 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,163 - julearn - INFO - Step added
2023-07-07 07:56:26,164 - julearn - INFO - Adding step model that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,164 - julearn - INFO - Tuning hyperparameter C = [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,164 - julearn - INFO - Setting hyperparameter kernel = linear
2023-07-07 07:56:26,164 - julearn - INFO - Step added
2023-07-07 07:56:26,164 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,164 - julearn - INFO - Step added
2023-07-07 07:56:26,164 - julearn - INFO - Adding step model that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,164 - julearn - INFO - Tuning hyperparameter max_depth = [2, 3, 4]
2023-07-07 07:56:26,164 - julearn - INFO - Step added
2023-07-07 07:56:26,164 - julearn - INFO - Adding step zscore that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,164 - julearn - INFO - Step added
2023-07-07 07:56:26,165 - julearn - INFO - Adding step model that applies to ColumnTypes&lt;types={&#39;continuous&#39;}; pattern=(?:__:type:__continuous)&gt;
2023-07-07 07:56:26,165 - julearn - INFO - Tuning hyperparameter penalty = [&#39;l2&#39;, &#39;l1&#39;]
2023-07-07 07:56:26,165 - julearn - INFO - Setting hyperparameter dual = False
2023-07-07 07:56:26,165 - julearn - INFO - Setting hyperparameter solver = liblinear
2023-07-07 07:56:26,165 - julearn - INFO - Step added
2023-07-07 07:56:26,165 - julearn - INFO - ==== Input Data ====
2023-07-07 07:56:26,165 - julearn - INFO - Using dataframe as input
2023-07-07 07:56:26,165 - julearn - INFO -      Features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:26,165 - julearn - INFO -      Target: species
2023-07-07 07:56:26,165 - julearn - INFO -      Expanded features: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]
2023-07-07 07:56:26,165 - julearn - INFO -      X_types:{&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;, &#39;petal_length&#39;, &#39;petal_width&#39;]}
2023-07-07 07:56:26,166 - julearn - INFO - ====================
2023-07-07 07:56:26,166 - julearn - INFO -
2023-07-07 07:56:26,167 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:26,167 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:26,167 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:26,167 - julearn - INFO -      model__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,168 - julearn - INFO -      model__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:26,168 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,168 - julearn - INFO - Search Parameters:
2023-07-07 07:56:26,168 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,168 - julearn - INFO - ====================
2023-07-07 07:56:26,168 - julearn - INFO -
2023-07-07 07:56:26,169 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:26,169 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:26,169 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:26,169 - julearn - INFO -      model__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,169 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,169 - julearn - INFO - Search Parameters:
2023-07-07 07:56:26,169 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,169 - julearn - INFO - ====================
2023-07-07 07:56:26,169 - julearn - INFO -
2023-07-07 07:56:26,170 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:26,170 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:26,170 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:26,170 - julearn - INFO -      model__max_depth: [2, 3, 4]
2023-07-07 07:56:26,171 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,171 - julearn - INFO - Search Parameters:
2023-07-07 07:56:26,171 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,171 - julearn - INFO - ====================
2023-07-07 07:56:26,171 - julearn - INFO -
2023-07-07 07:56:26,172 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:26,172 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:26,172 - julearn - INFO - Hyperparameters:
2023-07-07 07:56:26,172 - julearn - INFO -      model__penalty: [&#39;l2&#39;, &#39;l1&#39;]
2023-07-07 07:56:26,172 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,172 - julearn - INFO - Search Parameters:
2023-07-07 07:56:26,172 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,172 - julearn - INFO - ====================
2023-07-07 07:56:26,172 - julearn - INFO -
2023-07-07 07:56:26,172 - julearn - INFO - = Model Parameters =
2023-07-07 07:56:26,173 - julearn - INFO - Tuning hyperparameters using grid
2023-07-07 07:56:26,173 - julearn - INFO - Hyperparameters list:
2023-07-07 07:56:26,173 - julearn - INFO -      Set 0
2023-07-07 07:56:26,173 - julearn - INFO -              model__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,173 - julearn - INFO -              model__gamma: [0.001, 0.01, &#39;scale&#39;, &#39;auto&#39;]
2023-07-07 07:56:26,173 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:26,173 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:26,174 - julearn - INFO -              model: [SVC()]
2023-07-07 07:56:26,174 - julearn - INFO -      Set 1
2023-07-07 07:56:26,174 - julearn - INFO -              model__C: [0.01, 0.1, 1, 10]
2023-07-07 07:56:26,174 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:26,174 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:26,175 - julearn - INFO -              model: [SVC(kernel=&#39;linear&#39;)]
2023-07-07 07:56:26,175 - julearn - INFO -      Set 2
2023-07-07 07:56:26,175 - julearn - INFO -              model__max_depth: [2, 3, 4]
2023-07-07 07:56:26,175 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:26,175 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:26,176 - julearn - INFO -              model: [RandomForestClassifier()]
2023-07-07 07:56:26,176 - julearn - INFO -      Set 3
2023-07-07 07:56:26,176 - julearn - INFO -              model__penalty: [&#39;l2&#39;, &#39;l1&#39;]
2023-07-07 07:56:26,176 - julearn - INFO -              set_column_types: [SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]})]
2023-07-07 07:56:26,176 - julearn - INFO -              zscore: [StandardScaler()]
2023-07-07 07:56:26,177 - julearn - INFO -              model: [LogisticRegression(solver=&#39;liblinear&#39;)]
2023-07-07 07:56:26,177 - julearn - INFO - Using inner CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,177 - julearn - INFO - Search Parameters:
2023-07-07 07:56:26,177 - julearn - INFO -      cv: KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,177 - julearn - INFO - ====================
2023-07-07 07:56:26,177 - julearn - INFO -
2023-07-07 07:56:26,177 - julearn - INFO - = Data Information =
2023-07-07 07:56:26,177 - julearn - INFO -      Problem type: classification
2023-07-07 07:56:26,177 - julearn - INFO -      Number of samples: 100
2023-07-07 07:56:26,177 - julearn - INFO -      Number of features: 4
2023-07-07 07:56:26,177 - julearn - INFO - ====================
2023-07-07 07:56:26,178 - julearn - INFO -
2023-07-07 07:56:26,178 - julearn - INFO -      Number of classes: 2
2023-07-07 07:56:26,178 - julearn - INFO -      Target type: object
2023-07-07 07:56:26,179 - julearn - INFO -      Class distributions: species
versicolor    50
virginica     50
Name: count, dtype: int64
2023-07-07 07:56:26,179 - julearn - INFO - Using outer CV scheme KFold(n_splits=5, random_state=None, shuffle=False)
2023-07-07 07:56:26,179 - julearn - INFO - Binary classification problem detected.
Scores with best hyperparameter: 0.9200000000000002
{&#39;model&#39;: SVC(C=10, gamma=0.01),
 &#39;model__C&#39;: 10,
 &#39;model__gamma&#39;: 0.01,
 &#39;set_column_types&#39;: SetColumnTypes(X_types={&#39;continuous&#39;: [&#39;sepal_length&#39;, &#39;sepal_width&#39;,
                                       &#39;petal_length&#39;, &#39;petal_width&#39;]}),
 &#39;zscore&#39;: StandardScaler()}
</pre></div>
</div>
<p>Well, it seems that nothing can beat the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="(in scikit-learn v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SVC</span></code></a> with
<code class="docutils literal notranslate"><span class="pre">kernel=&quot;rbf&quot;</span></code> for our classification example.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  18.730 seconds)</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="model_inspect.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">3.4. </span>Inspecting Models</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="confound_removal.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">3.2. </span>Cross-validation consistent Confound Removal</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Authors of julearn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3.3. Hyperparameter Tuning</a><ul>
<li><a class="reference internal" href="#parameters-vs-hyperparameters">Parameters vs Hyperparameters</a></li>
<li><a class="reference internal" href="#id1">Hyperparameter Tuning</a></li>
<li><a class="reference internal" href="#searchers">Searchers</a></li>
<li><a class="reference internal" href="#tuning-more-than-one-grid">Tuning more than one <em>grid</em></a></li>
<li><a class="reference internal" href="#models-as-hyperparameters">Models as hyperparameters</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom.js"></script>
    </body>
</html>